<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Hitster Web</title>
<meta name="theme-color" content="#0b0b0d">
<style>
:root{--bg:#0b0b0d;--text:#f5f5f7;--muted:rgba(245,245,247,.72);--border:rgba(245,245,247,.12)}
*{box-sizing:border-box}
body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Inter,Arial,sans-serif;padding:18px}
.wrap{width:min(920px,100%);display:flex;flex-direction:column;gap:14px}
h1{margin:0;font-size:28px}
.sub{margin:0;color:var(--muted);font-size:14px}
.pill{display:inline-flex;gap:8px;border:1px solid var(--border);padding:8px 12px;border-radius:999px;color:var(--muted);font-size:13px}
.card{border:1px solid var(--border);border-radius:18px;background:rgba(255,255,255,.04)}
.card-inner{padding:16px}
.actions{display:flex;gap:10px;justify-content:center;padding:16px;border-top:1px solid var(--border)}
button{border:1px solid var(--border);background:rgba(255,255,255,.08);color:var(--text);border-radius:16px;padding:14px 22px;font-size:18px;font-weight:700}
button.primary{font-size:34px;padding:20px 44px}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:760px){.grid{grid-template-columns:1fr 1fr}}
.box{border:1px solid var(--border);border-radius:16px;padding:12px}
.label{color:var(--muted);font-size:12px}
.value{font-size:18px}
.year{font-weight:900}
a{color:inherit}
</style>
</head>
<body>
<div class="wrap">
<div class="pill" id="status">Carico‚Ä¶</div>
<h1>üé∂ Hitster Web</h1>
<p class="sub">Premi PLAY: si apre Spotify e qui vedi titolo, artista e anno.</p>
<div class="card">
<div class="card-inner">
<div class="grid">
<div class="box"><div class="label">Titolo</div><div class="value" id="tTitle">‚Äî</div></div>
<div class="box"><div class="label">Artista</div><div class="value" id="tArtist">‚Äî</div></div>
<div class="box"><div class="label">Anno</div><div class="value year" id="tYear">‚Äî</div></div>
<div class="box"><div class="label">Link</div><div class="value"><a id="tLink" href="#" target="_blank">Apri su Spotify</a></div></div>
</div>
</div>
<div class="actions">
<button class="primary" id="play" disabled>‚ñ∂ PLAY</button>
<button id="reveal" disabled>üëÅÔ∏è Rivela</button>
</div>
</div>
</div>
<script>
let CARDS=[],bag=[];
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a}
async function load(){const r=await fetch("./cards.csv",{cache:"no-store"});const t=await r.text();
const rows=t.trim().split(/\r?\n/).map(l=>l.split(","));const h=rows.shift().map(s=>s.toLowerCase());
const iL=h.indexOf("spotify_link"),iT=h.indexOf("titolo"),iA=h.indexOf("artista"),iY=h.indexOf("anno");
CARDS=rows.map(r=>({link:r[iL],titolo:r[iT],artista:r[iA],anno:r[iY]}));bag=shuffle([...Array(CARDS.length).keys()]);
document.getElementById("status").textContent="OK ("+CARDS.length+")";
document.getElementById("play").disabled=false;document.getElementById("reveal").disabled=false}
let last=null;
function next(){if(!bag.length)bag=shuffle([...Array(CARDS.length).keys()]);return bag.pop()}
function show(c){tTitle.textContent=c.titolo||"‚Äî";tArtist.textContent=c.artista||"‚Äî";tYear.textContent=c.anno||"‚Äî";tLink.href=c.link||"#"}
play.onclick=()=>{const c=CARDS[next()];last=c;window.open(c.link,"_blank");show(c)}
reveal.onclick=()=>{if(last)show(last)}
load().catch(()=>status.textContent="Errore cards.csv")
</script>
</body>
</html>
